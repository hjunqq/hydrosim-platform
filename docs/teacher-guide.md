# 教师使用手册 (Teacher Guide)

欢迎使用智慧水利毕业设计部署平台。本手册将指导您完成从学生管理到应用部署的全流程操作。

## 1. 快速入门

### 环境准备
确保您已登录教师管理门户（默认为 `http://localhost:8080` 或您的部署地址）。

### 核心流程
1.  **创建项目**: 录入学生信息和 Git 仓库地址。
2.  **代码开发**: 学生将代码推送到 Git 仓库，触发 CI/CD 构建镜像。
3.  **应用部署**: 在平台上一键部署应用到 Kubernetes 集群。
4.  **状态监控**: 实时查看应用运行状态和访问域名。

---

## 2. 学生项目管理

### 批量导入学生
如果您有大量学生名单，可以使用脚本或 CSV 导入功能（需管理员操作后台脚本）：
```bash
# 示例：使用后端脚本批量导入
./scripts/student/batch-create.sh students.csv
```
_注：Web 界面的批量导入功能正在开发中。_

### 手动创建学生
1.  进入 **"学生项目列表"** 页面。
2.  点击右上角 **"+ 新建项目"**。
3.  填写以下信息：
    *   **学号**: 学生的唯一标识 (如 `s2025001`)。
    *   **姓名**: 学生姓名。
    *   **项目类型**:
        *   `毕业设计 (gd)`: 资源配额较高，部署在 `students-gd` 命名空间。
        *   `课程设计 (cd)`: 资源配额较低，部署在 `students-cd` 命名空间。
    *   **Git 仓库地址**: 学生的代码仓库 URL (用于关联 CI/CD)。

---

## 3. 应用部署 (Deployment)

当学生完成代码开发并构建好 Docker 镜像后，您可以协助或允许其部署应用。

### 部署步骤
1.  在 **"学生项目列表"** 中找到对应学生。
2.  点击 **"立即部署"** (或 "重新部署")。
3.  **填写部署配置**:
    *   **Docker 镜像 (Image)**: 输入学生构建好的镜像地址。
        *   *格式示例*: `registry.example.com/project/s2025001:v1`
        *   *注意*: 请勿使用默认的测试镜像，需确保镜像已推送至仓库且集群可拉取。
    *   **项目类型**: 系统自动锁定，无需修改。
4.  点击 **"开始部署"**。

### 部署后验证
系统会自动在后台执行以下操作：
1.  **创建 Namespace**: 确保对应的 `students-gd` 或 `students-cd` 命名空间存在。
2.  **应用资源**: 创建 Kubernetes Deployment 和 Service。
3.  **配置路由 (Ingress)**: 自动生成访问域名 (如 `s2025001.gd.hydrosim.cn`)。

---

## 4. 监控与运维

### 查看部署状态
在列表页，您可以直观地看到每个项目的状态：
*   🟢 **运行中 (Running)**: 应用正常运行，域名可访问。
*   🟡 **待部署 (Pending)**: 尚未创建部署。
*   🔴 **异常 (Failed)**: 部署失败或 Pod 无法启动 (如镜像拉取失败)。

### 集群资源视图 (高级)
点击左侧菜单的 **"部署记录"** (Cluster Resources)，您可以查看 Kubernetes 集群中所有实际运行的 Pod 和 Deployment。这不仅限于数据库中记录的项目，而是对集群状态的真实反映。

### CI/CD 流水线 (Workflows)
系统集成了 Gitea Actions。未来在学生详情页，您可以查看代码推送后触发的自动构建日志，帮助学生排查编译或构建错误。

---

## 5. 常见问题 (FAQ)

**Q: 部署显示 "ImagePullBackOff" 错误？**
A: 通常是因为镜像地址错误，或者集群没有权限拉取该私有仓库的镜像。请检查 Image 字段是否正确。

**Q: 域名无法访问 (404 Not Found)？**
A: 
1. 检查 Ingress Controller 是否正常工作。
2. 确保本地 hosts 或 DNS 已解析该域名到集群 Ingress IP。

**Q: 如何更新应用？**
A: 学生推送新代码并构建新镜像 tag 后，点击 "重新部署" 并填入新的 Image Tag 即可触发滚动更新。
