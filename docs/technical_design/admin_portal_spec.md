# 管理员功能原型说明

本文件用于指导设计“管理员视角”的新增模块，包含全局项目视图、镜像仓库接入、资源监控。

## 1. 角色与权限

- 角色：管理员 (Admin)、教师 (Teacher)
- 管理员可见：全量项目（跨教师/班级/命名空间）、镜像仓库管理、资源监控
- 教师可见：仅自己名下项目、部署状态、历史
- 权限边界：管理员可执行“停/启/回滚/删除/强制重部署”，教师仅“部署/查看/编辑元数据”

## 2. 信息架构（导航）

- 首页 Dashboard
- 项目管理（管理员：全量项目；教师：仅个人项目）
- 镜像仓库（仅管理员）
- 资源监控（仅管理员）
- 系统设置（仅管理员）

## 3. 管理员全局项目视图（Projects / Admin）

目标：统一查看所有学生项目并快速定位异常项目。

### 页面结构

- 顶部统计卡片：总项目数 / 运行中 / 部署中 / 异常 / 未部署
- 过滤器：教师、班级/课程、项目类型 (gd/cd)、状态、命名空间、关键词
- 主表格字段：
  - 学生姓名、学号、项目类型、所属教师、命名空间、域名
  - 最新镜像 tag、最近部署时间、状态（健康/异常）
- 行操作：
  - 详情、重新部署、停/启、查看日志、删除

### 详情侧栏/抽屉

- 项目配置（镜像、域名、Git）
- 部署历史
- 运行状态
- Pod/Service/Ingress 快捷链接

## 4. 镜像仓库接入页（Registry）

目标：管理平台可用镜像仓库，并让管理员快速选择镜像。

### 主要功能

- 仓库列表卡片：
  - 名称、类型（Harbor/Docker Registry/OCI）、地址、认证状态、最后同步时间
- 仓库详情（或抽屉）：
  - 镜像列表：仓库/项目、镜像名、最新 tag、大小、最后推送、拉取次数
  - 标签列表：tag、digest、创建时间、大小、被哪些项目使用
- 操作：
  - 新增/编辑仓库（地址、协议、账号/Token、TLS 校验、默认命名空间）
  - 连接测试、同步镜像、设置为推荐镜像
  - 复制拉取命令、将镜像分配给项目

### 状态设计

- 空态：未接入仓库时显示引导
- 失败态：连接失败/认证失败，显示“重新测试”

## 5. 资源监控页（Monitoring）

目标：管理员查看集群资源消耗与异常。

### 页面结构

- 总览卡片：集群健康、节点数量、CPU/内存使用率、异常 Pod 数
- 资源趋势图：CPU/内存使用趋势（1h/24h/7d）
- 维度切换：命名空间 / 节点 / 项目
- 表格区：
  - Top 资源消耗项目
  - 异常项目列表（CrashLoopBackOff、ImagePullBackOff）

### 操作

- 一键跳转项目详情
- 临时停止项目 / 缩容
- 查看 Pod 事件与日志（只读）

## 6. 设计要求

- 保持现有 UI 风格：现代卡片 + 轻量表格 + 状态徽章
- 异常状态高亮（红色标识 + 可操作入口）
- 列表支持搜索、筛选、分页、导出

## 7. 需要的后端数据（占位）

- 项目列表：owner_teacher、namespace、status、latest_image、domain
- 仓库列表：type、address、auth_status、last_sync
- 镜像清单：tags、digest、size、last_push
- 资源指标：CPU/Memory/Pod 状态
